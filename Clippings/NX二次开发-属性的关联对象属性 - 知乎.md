# NX二次开发-属性的关联对象属性 - 知乎
对象属性

作者：纪新杭 审校：金雷 适用版本：NX6以上版本

一、概述

在很多项目中，需要通过属性达到标记对象、记录信息或是数据传递等作用。而其中数据传递又可以划分为属性关联属性、属性关联表达式和表达式关联属性三种常用方式。之前介绍过属性关联属性传递方式是在同一个对象中的属性相互关联，而本文将以NX10为例，介绍属性关联其他对象属性的方式。

二、功能说明

对象属性关联其他对象属性：即将一个或多个对象的属性的值关联到另外一个对象的属性上。

如图1所示为属性关联属性的代码，需要特别注意的是如果关联的属性名称已经存在对应属性，但类型不是“关联类型”时，是无法正常赋予属性值的，需要先删除原先属性后再创建新的属性。

![](https://pic1.zhimg.com/v2-e7446fb99d01eb187c2a4bfbe1f00b38_b.jpg)

图1

基于上述关联方法，只需要在原来的属性值中插入“对象的Tag值”即可进行关联，如图2所示（这里的Tag值是代码中“NXObject”对象都具备的属性）。

![](https://pic3.zhimg.com/v2-431b790bc4465ca5bd014a3c4cf3c0e6_b.jpg)

图2

项目实际用途：在项目实施过程中，经常会出现主模型出图，且图纸模型的图号（PART\_NO）和名称（PART\_NAME）属性一般直接继承产品模型。实现代码如图3所示。

![](https://pic3.zhimg.com/v2-20169d8ff924fecc37beec7ff65bacde_b.jpg)

图3

注意事项：关联的对象必须是手动操作也可以关联的对象。例如主模型出图时，零件的部件（Part）本身属性是没发直接关联的，只能关联零件的组件（Component）属性。

三、总结

除了上述项目使用实例外，还可以用于属性名不同的属性间关联。而由二次开发来执行关联的前提是，该关联无法提前做成模板化，或者做成模板化的难度较大。因为一旦由二次开发介入类似的关联操作，就得连带考虑各种关联失败、何时检查关联状态以及手动误删等场景，增加整体项目负担。