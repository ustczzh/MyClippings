# NX二次开发-树列表实现双击编辑功能 - 知乎
作者：纪新杭 审校：金雷

适用版本：NX6以上版本

一、概述

在功能实现时，NX二次开发人员经常会使用树列表（Tree）来列举长度不固定的数组信息，而且还可能对这些信息数据进行编辑操作。本文将以NX10为例，介绍两种自带的编辑树列表的方法，并对比其优缺点。

二、功能说明

第一种编辑方法——“SetAskEditControlHandler”。该方法用于设置编辑时采取什么样的控件。而其三种控件分别是ListBox（列表框）、ComboBox（复合框）和None（不可编辑）。前两个控件的下拉菜单通过“SetEditOptions”方法进行设置。最终是否接受编辑需要采用“SetOnEditOptionSelectedHandler”方法来确定。代码如图1所示，效果如图2、3、4所示。

![](https://pic4.zhimg.com/v2-afaf259f1f0cb59b2618561b4f70aff3_b.jpg)

图1

![](https://pic1.zhimg.com/v2-d41ec1526ae10fd9e96c43d3cd576788_b.jpg)

图2

![](https://pic3.zhimg.com/v2-6fb9c84e1e0031b7a92cd7367f9d0886_b.jpg)

图3

![](https://pic2.zhimg.com/v2-845147db7c309b80a48af757c623fa0d_b.jpg)

图4

第二种编辑方法——“SetOnBeginLabelEditHandler”。该方法用于设置开始编辑标签所执行内容，以及确定哪一列可编辑。最终是否接受编辑需要采用“SetOnEndLabelEditHandler”方法来确定。手动触发编辑标签的方法是按下键盘键“F2”，为了人性化操作，我们采用树列表的双击回调“SetOnDefaultActionHandler”来模拟手动触发。代码如图5所示，效果如图6所示。

![](https://pic3.zhimg.com/v2-9e1a98f9add1e3bf4c7c051dbd1bd7ea_b.jpg)

图5

![](https://pic4.zhimg.com/v2-22763974ef15ef636796425f608d772f_b.jpg)

图6

结合上面两个编辑方法，编辑方式可以总结为三个方式。其中列表框的方式和另外两种方式没有可比性，下面比较复合框和标题编辑。

复合框：优点是除了手输，还有下拉的内容可以直接选择，对编辑的列个数没有限制；缺点是无法自由的鼠标左键选择光标位置，需要通过键盘的左键、右键来移动光标位置。

标题编辑：优点是可以自定义触发条件，光标位置可以自由选择；缺点是没有下拉项可以选择，而且一行只能编辑一个单元格。

三、总结

除了上述的编辑方式，还其他的非树列表自带编辑方式。例如选择行数据后显示新控件进行编辑、或是双击行数据后，弹出新界面编辑等方式。只要是能满足需求，且功能人性化，采用哪种方式均可。