# NX二次开发-表格注释中使单元格大小跟随文本大小 - 知乎
作者：黄盛益 审校：薛剑腾

适用版本：NX7.5以上

一、概述

表格注释是一种常用的表格数据管理方式。在低版本中，无法使用NXOpen的方式创建表格注释，故采用UF的方式创建，那么，在创建表格时，如何让表格的单元格大小自动跟随单元格中的文本大小呢？本文主要介绍如何解决上述问题。

二、功能说明

首先，通过手动操作的方式得知，创建完表格后，将表格注释的单元格样式设置为以下形式，即可实现单元格大小跟随文本大小。

![](https://pic2.zhimg.com/v2-e912f5494d5aaeedd73123d271f3cc09_b.jpg)

在上述手动操作中，不管是先填入文本后设置格式，还是先设置格式再填入文本，单元格都能做到自动跟随文本大小，而是这个原因，在初期的时候带来了一些麻烦，在首先尝试了填入文本后再设置单元格样式，代码如下图所示：

![](https://pic2.zhimg.com/v2-71ebc5fc04ad44c6792ef74e9ab04cc1_b.jpg)

发现表格注释中除了最后一列的单元格之外，其他的单元格只有第一行的单元格做到了跟随文本，其他的均会被压缩文本为第一行对应列的单元格的大小，也是因为如此，前期一度放弃了通过此种方式去实现单元格的跟随，直到后面转变了一下思维：既然先填入文本后设置单元格无法实现，那么先设置单元格样式再填入文本呢？经过一个简单的执行顺序调整，发现这个小小的调整便能完美的解决问题了，完整代码如下图所示：

![](https://pic3.zhimg.com/v2-fb5d72af6b460e0a93deb950c00e8d2a_b.jpg)

![](https://pic1.zhimg.com/v2-541910e2b1a54ea3c687f4d08bd1e958_b.jpg)

![](https://pic2.zhimg.com/v2-8ece7e49ee5f13b6aa0aac51aad612b1_b.jpg)

三、总结

在二次开发的过程中，在尝试一个新式的办法时，不要急于去全盘否定这个方法，有可能只是在一些细节上没处理好，而不是这个思路本身的问题，不要过于依赖手动操作的结果，有时候细节决定成败。