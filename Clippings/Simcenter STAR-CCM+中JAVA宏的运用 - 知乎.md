# Simcenter STAR-CCM+中JAVA宏的运用 - 知乎
作者：张艳松 审校：陈志愿

适用版本：STAR-CCM

1、概述

Simcenter STAR-CCM+中JAVA宏编制可用于通过自动执行重复任务，提高工作效率。例如，报告、自动保存、自动导出和场景硬拷贝都可以在模拟属性中予以指定。可能需要宏才能广泛地自定义或自动设置相关属性，使模拟之间的这些属性均相同。与其他宏系统不同，Simcenter STAR-CCM+不会录制任何鼠标移动、按钮单击和按键，而是将工作区中的操作转化为有意义的 Java 代码。宏文件为 Java 语言文件，可以录制为与应用程序之间互动的日志。虽然通过 Simcenter STAR-CCM+ 会话创建宏文件最为简便，但是也可以在文件编辑器中对其进行手动编辑。例如，可以使用 Java 编程语言的全部功能使这些文件专用于特定应用程序。

2、编辑宏

宏文件是一种常规文件，其中包含可根据任务进行编辑和自定义的 Java 代码。

例如，如果要将批处理作业运行的迭代数从 1 更改为 1000。 在首选文本编辑器中，打开 .java 文件，然后查找与以下内容相似的行：

simulation\_0.getSimulationIterator().step(1);

根据需要更改迭代计数：

simulation\_0.getSimulationIterator().step(1000);

或者更好的办法是使用 run 函数：

simulation\_0.getSimulationIterator().run();

例如，在宏中加循环语句，进行重复操作：

![](https://pic3.zhimg.com/v2-f1bf243ac59e89c50392bc4a5c79e812_b.jpg)

其他一些典型编辑示例有：

• 加载到不同的案例文件中

• 添加环以更改属性，从而模拟旋转起速的转子

• 作为时间函数改变属性

3、使用默认宏

默认宏为 Java 宏，在每个互动会话开始时自动创建。

互动会话期间，Simcenter STAR-CCM+ 将自动为默认宏中的每个操作录制 Java 代码。

![](https://pic4.zhimg.com/v2-f71dfe7fbccce536c3ba3b6919bdee47_b.jpg)

当使用“播放宏”命令播放在会话期间执行的操作序列时，可使用默认宏重复该序列。 可在模拟的任意时间点通过 Simcenter STAR-CCM+ GUI 保存默认宏的副本。

启动新会话时，输出窗口中将显示系统中存储默认宏的目录路径，如上截图所示。

默认宏功能在 Simcenter STAR-CCM+ 中已作为标准激活，但是可根据需要停用。 在为每个互动会话生成默认宏后，建议偶尔清空默认宏目录，以确保它不会变得混乱。

![](https://pic1.zhimg.com/v2-453170168fd731fbb7616574bbe0dbe4_b.jpg)

如果需要重新激活默认宏的创建，则重复上述过程并激活默认宏属性。

对此设置的更改仅在后续互动会话中生效。 例如，启动新模拟时或打开现有 .sim 文件时。 关闭并重新打开Simcenter STAR-CCM+ 后，该设置会保留。