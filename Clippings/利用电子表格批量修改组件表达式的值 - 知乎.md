# 利用电子表格批量修改组件表达式的值 - 知乎
作者：陈杰 审校：曾莉梅

适用版本：NX

产品部件设计过程中工程师常采用自底向上，即先设计好零件，再装配的设计模式。当设计变更发生时，需要对每个零件逐一进行修改，即使我们修改的是同一类的设计参数，也不能快速实现这种变更，如某批量零件高度尺寸。

NX提供电子表格批量修改组件表达式的方法来解决这个问题。该方法前提是装配中有多个组件需要修改表达式的值，它们之间并没有定义部件间表达式，但是采用了完全相同的表达式名。下面以具体案例分享该功能使用场景。以图1装配assm为例，它包含三个组件：长方体comp1、圆柱体comp2、圆台comp3，三个组件都有一个高度表达式height=50。假设设计需求是需要将长方体和圆柱体的高度更改为100。具体操作步骤如下：

![](https://pic3.zhimg.com/v2-4f2be047005499170b32c3430ed2904a_b.jpg)

图1

第一步 启动电子表格：选择【菜单】【工具】【电子表格】。

注意：如果看到未正确注册 SPLM Excel 插件错误消息，请从 NX 安装目录的install 文件夹中运行 register\_splm\_files.bat，NX 将注册指定的插件。

第二步 定义更新方法：在启动的Excel表中选择【加载项】【选项】【更新方法】，选择【根部件层叠更新】，点击【确定】，如图2。

![](https://pic2.zhimg.com/v2-8b1563354a6769a7138dade3ed06e305_b.jpg)

图2

第三步 定义更新范围：在单元格A2中写入长方体组件名comp1.prt，A3中写入圆柱体组件名comp2.prt，选中单元格A2和A3，选择【加载项】【定义装配范围】，如图3。

![](https://pic4.zhimg.com/v2-e587061fd3affed7586dade2e5c722c3_b.jpg)

图3

第四步 定义表达式：在单元格A6中写入表达式名height，B6中写入表达式值100，选择【加载项】【定义表达式范围】，如图4。

![](https://pic3.zhimg.com/v2-f2e6b126f39f8ec624022664582ea1aa_b.jpg)

图4

第五步 更新组件：选择【加载项】【更新NX部件】，可以看到NX中长方体和圆柱体高度已经变成100，如图5。选择【文件】【关闭】退出电子表格。

![](https://pic4.zhimg.com/v2-2f90e6620f420c1c2a0f534a1c5e5b3f_b.jpg)

图5

使用根部件层叠更新方法可以把表达式的值从一个根部件中的电子表格传递到装配的其他组件。软件通过定义装配范围命令所选择的区域，逐行更新定义的组件。而没有定义的组件，即使表达式名称相同也不会被更新。这种方法特别适用于在装配中加入的历史数据。